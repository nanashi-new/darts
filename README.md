# Darts Rating EBCK

## Что это за программа
Это программа для судьи и тренера по дартсу. Она помогает вести игроков и турниры, быстро загружать результаты из Excel, автоматически считать рейтинг и разряды, а затем выгружать готовые таблицы и отчёты.

Программа работает на Windows и не требует интернета.

## Установка (Windows)
1. Скачайте архив с программой.
2. Распакуйте архив в удобную папку (например, на рабочий стол или диск D).
3. Откройте папку и запустите файл программы (обычно `DartsRatingEBCK.exe`).

Если Windows покажет предупреждение при первом запуске, нажмите «Подробнее» → «Выполнить в любом случае».

## Первый запуск
При первом запуске программа сама создаёт рабочие данные и папки.

Обычно автоматически создаются:
- база данных с игроками и турнирами;
- файл настроек;
- папки для импорта и экспорта;
- папка для логов (журнала);
- служебные файлы для работы с нормами и профилями импорта.

После этого можно сразу переходить к добавлению турниров или импорту Excel.

## Где хранятся данные
Данные программы хранятся в профиле пользователя Windows.

Основной путь:
- `%APPDATA%\<папка приложения>`

В этой папке находятся:
- база данных;
- настройки;
- логи (журнал);
- профили импорта;
- экспортированные файлы.


## Основные разделы
### Игроки
- Список всех игроков.
- Поиск по ФИО.
- Открытие карточки игрока с историей турниров.

### Турниры
- Создание и редактирование турниров.
- Просмотр результатов по каждому турниру.
- Быстрый пересчёт после изменений.

### Рейтинг
- Общий рейтинг по выбранной категории.
- Фильтры и поиск.
- Пересчёт после новых данных.

### Импорт-Экспорт
- Импорт одного файла или папки с файлами.
- Экспорт таблиц и отчётов.
- Пакетные операции.

### Отчёты
- Подготовка печатных и электронных отчётов.
- Выгрузка в нужный формат.

### Настройки
- Основные параметры работы программы.
- Параметры импорта/экспорта и расчётов.

### Журнал
- История действий и ошибок.
- Помогает понять, что пошло не так при импорте или пересчёте.

## Импорт
Варианты импорта:
- **Файл** — загрузка одного Excel-файла.
- **Папка** — обработка сразу нескольких файлов.
- **Мульти-таблицы** — если в одном файле несколько таблиц результатов.

Если колонки в файле названы нестандартно, используйте **мастер сопоставления**:
- укажите, где ФИО, место, очки и другие поля;
- сохраните настройки как **профиль**, чтобы в следующий раз загружать быстрее.

После импорта проверьте итог: сколько строк загружено и были ли предупреждения.

## Пересчёт
В программе есть два основных режима:
- **Пересчёт турнира** — когда изменили один конкретный турнир;
- **Пересчёт всего** — когда нужно обновить рейтинг по всем данным.

Рекомендуется использовать пересчёт всего после крупного импорта.

## Экспорт
Доступные форматы:
- **PDF** — для печати и отправки;
- **XLSX** — для работы в Excel;
- **PNG** — как изображение таблицы.

Варианты выгрузки:
- **Видимая область** (то, что сейчас на экране);
- **Вся таблица** (полный объём данных);
- **Batch export** — пакетный экспорт нескольких отчётов за один раз.

## Дубли игроков и слияние
Иногда один и тот же человек попадает в базу дважды (например, с разным написанием ФИО).

Что делать:
1. Откройте раздел работы с дублями.
2. Выберите две карточки одного игрока.
3. Проверьте данные перед объединением.
4. Выполните слияние.

После слияния результаты и очки должны остаться в одной карточке игрока.

## Журнал и экспорт лога
Если возникла ошибка:
1. Откройте раздел **Журнал**.
2. Найдите запись по времени.
3. Посмотрите текст ошибки или предупреждения.
4. При необходимости выгрузите лог в файл и передайте ответственному специалисту.

Это самый быстрый способ понять причину проблемы.

## Если что-то не получается
Порядок проверки:
1. Сначала откройте **Журнал** и посмотрите последнюю ошибку.
2. Проверьте раздел **ошибок импорта** (если проблема при загрузке Excel).
3. Убедитесь, что файл соответствует нужной структуре.
4. Проверьте, правильно ли выбраны нормы и параметры расчёта.
5. Выполните повторный импорт через профиль или мастер сопоставления.
6. Запустите пересчёт ещё раз (турнир или всё).

Если ошибка повторяется, сохраните лог и передайте его вместе с проблемным файлом.
