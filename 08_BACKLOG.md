# 08 — Бэклог задач (ориентирован на Codex)

Связанные документы:
- Требования: [01_REQUIREMENTS.md](01_REQUIREMENTS.md)
- Правила: [02_RULES_ALGORITHMS.md](02_RULES_ALGORITHMS.md)
- Импорт Excel: [04_IMPORT_EXPORT_XLSX.md](04_IMPORT_EXPORT_XLSX.md)
- Архитектура: [07_ARCHITECTURE.md](07_ARCHITECTURE.md)
- Тест-план: [09_TEST_PLAN.md](09_TEST_PLAN.md)

---

## Как использовать этот бэклог

- Реализовывать **строго по порядку**
- Каждая задача — отдельный запрос к Codex
- После каждого EPIC — ручная проверка
- Domain → Services → UI (не наоборот)

---

# EPIC A — Каркас приложения

## A1. Создание базового Qt-приложения
**Цель:** приложение запускается, есть главное окно.

**Задачи:**
- создать `main.py`;
- инициализировать `QApplication`;
- создать `MainWindow` с вкладками;
- добавить меню «О программе».

**Готово, если:**
- окно открывается;
- вкладки переключаются.

---

## A2. Навигация и состояние
- сохранить последнюю вкладку;
- сохранить размер окна;
- восстановить при старте.

---

# EPIC B — База данных

## B1. Инициализация SQLite
**Цель:** создать `app.db`.

**Задачи:**
- создать подключение;
- создать таблицы `players`, `tournaments`, `results`;
- проверить индексы.

**Готово, если:**
- CRUD работает;
- данные сохраняются между запусками.

---

## B2. Репозитории
Создать классы:
- `PlayerRepository`
- `TournamentRepository`
- `ResultRepository`

Методы:
- create / update / delete / list / find.

---

## B3. Бэкап и перенос
**Цель:** перенос между ПК.

**Задачи:**
- экспорт `app.db` в ZIP;
- импорт ZIP;
- проверка версии БД.

---

# EPIC C — Импорт XLSX (критично)

## C1. Импорт одного файла
**Вход:** `.xlsx`  
**Выход:** список строк для предпросмотра.

**Шаги:**
- открыть файл;
- найти заголовки;
- считать строки;
- валидировать данные.

---

## C2. Импорт нескольких таблиц в одном файле
- определить границы таблиц;
- разделить на блоки;
- каждый блок — отдельный импорт.

---

## C3. Импорт папки
- выбрать папку;
- пройти по всем `.xlsx`;
- прогрессбар;
- лог ошибок.

---

## C4. Мастер сопоставления колонок
**UI + логика**

- показать предпросмотр;
- пользователь назначает колонки;
- сохранить профиль импорта;
- повторно использовать профиль.

---

# EPIC D — Domain (алгоритмы)

## D1. Нормативы ЕВСК
- загрузка из xlsx/json;
- версия нормативов.

---

## D2. Определение разряда
**Функция:**  
`get_rank(score, discipline, age, gender)`

**Готово, если:**
- тесты проходят;
- крайние случаи обработаны.

---

## D3. Начисление очков
- разряд → очки;
- место → очки;
- итог турнира.

---

## D4. Rolling-рейтинг
**Функция:**  
`calculate_rating(player_id, category, N)`

- сортировка по дате;
- сумма последних N;
- стабильный результат.

---

# EPIC E — Экраны

## E1. Экран «Игроки»
- список;
- поиск;
- карточка игрока;
- история турниров.

---

## E2. Экран «Турниры»
- список турниров;
- карточка турнира;
- импорт;
- пересчёт;
- экспорт протокола.

---

## E3. Экран «Рейтинг»
- фильтры;
- поиск;
- выбор N;
- экспорт PDF/XLSX/PNG.

---

# EPIC F — Экспорт и печать

## F1. Экспорт PDF
- таблица рейтинга;
- A4 landscape;
- переносы строк.

---

## F2. Экспорт Excel
- автоширина;
- заголовки;
- готово к печати.

---

## F3. Экспорт изображения
- рендер таблицы;
- сохранение PNG/JPG.

---

# EPIC G — FAQ и помощь

## G1. Встроенный FAQ
- загрузка `FAQ.txt`;
- поиск по словам;
- быстрые ссылки.

---

# EPIC H — Качество

## H1. Логирование ошибок
- импорт;
- пересчёт;
- экспорт.

---

## H2. Автотесты
- domain-тесты;
- импорт-тесты.

---

## H3. Демо-данные
- кнопка «Загрузить пример».

---

Конец бэклога.